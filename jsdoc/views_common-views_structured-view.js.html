<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: views/common-views/structured-view.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: views/common-views/structured-view.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
import $      from '$qui/lib/jquery.module.js'
import Logger from '$qui/lib/logger.module.js'

import {Mixin}           from '$qui/base/mixwith.js'
import StockIcon         from '$qui/icons/stock-icon.js'
import VisibilityManager from '$qui/utils/visibility-manager.js'
import * as Window       from '$qui/window.js'


const logger = Logger.get('qui.views.commonviews.structuredview')


/** @lends qui.views.commonviews.StructuredViewMixin */
const StructuredViewMixin = Mixin((superclass = Object) => {

    /**
     * A view with top, body and bottom elements. Designed to be mixed together with {@link qui.views.ViewMixin}.
     * @alias qui.views.commonviews.StructuredViewMixin
     * @mixin
     */
    class StructuredViewMixin extends superclass {

        /**
         * @constructs
         * @param {?String} [title] view title (set to `null` if you don't want a view top at all)
         * @param {qui.icons.Icon} [icon] view icon
         * @param {Boolean} [minimizable] indicates that the view should be minimizable by clicking on its top bar
         * (defaults to `false`)
         * @param {Boolean} [minimized] indicates that the view should be initially minimized (defaults to `false`)
         * @param {Boolean} [largeTop] indicates that the view top bar should be larger (defaults to `true`)
         * @param {Boolean} [topless] indicates that the view should not have a top bar (defaults to `false`)
         * @param {Boolean} [closable] set to `true` to display a close button on the top bar (defaults to `false`,
         * ignored when `minimizable` is `true`)
         * @param {...*} args parent class parameters
         */
        constructor({
            title = null,
            icon = null,
            minimizable = false,
            minimized = false,
            largeTop = true,
            topless = false,
            closable = false,
            ...args
        } = {}) {
            super(args)

            this._title = title
            this._icon = icon
            this._minimizable = minimizable
            this._minimized = minimized
            this._largeTop = largeTop
            this._topless = topless
            this._closable = closable

            this._topDiv = null
            this._bodyDiv = null
            this._bottomDiv = null
            this._bodyVisibilityManager = null
        }


        /* HTML */

        initHTML(html) {
            html.addClass('qui-structured-view')

            this._topDiv = this._makeTop()
            html.append(this._topDiv)

            if (!this._icon) {
                html.addClass('iconless')
            }

            if (this._largeTop) {
                html.addClass('large-top')
            }

            if (this._topless) {
                html.addClass('topless')
            }

            if (this._closable) {
                html.addClass('closable')
            }

            if (this._minimizable) {
                html.addClass('minimizable')
                this._topDiv.addClass('qui-base-button')
                this._topDiv.on('click', function () {
                    this.toggleMinimized()
                }.bind(this))
            }

            this._bodyDiv = this.makeBody()
            this._bodyDiv.addClass('qui-structured-view-body')

            this._bodyVisibilityManager = new VisibilityManager({
                element: this._bodyDiv,
                heightTransition: true
            })

            html.append(this._bodyDiv)

            if (this._minimizable) {
                if (this._minimized) {
                    this._bodyVisibilityManager.hideElement()
                    html.addClass('minimized')
                }
                else if (this._topDiv) {
                    this._topDiv.addClass('selected')
                }
            }

            this._bottomDiv = this.makeBottom()
            if (this._bottomDiv) {
                this._bottomDiv.addClass('qui-structured-view-bottom')
                html.append(this._bottomDiv)
            }
        }

        _makeTop() {
            let topDiv = $('&lt;div>&lt;/div>', {class: 'qui-structured-view-top'})
            let iconDiv = $('&lt;div>&lt;/div>', {class: 'qui-structured-view-icon'})
            topDiv.append(iconDiv)

            if (this._icon) {
                this.prepareIcon(this._icon).applyTo(iconDiv)
            }

            let titleSpan = $('&lt;span>&lt;/span>', {class: 'qui-structured-view-title'})
            titleSpan.text(this._title || '')
            topDiv.append(titleSpan)

            if (this._minimizable) {
                let minimizeIconDiv = $('&lt;div>&lt;/div>', {class: 'qui-structured-view-minimize-button'})

                new StockIcon({
                    name: 'fat-arrow', variant: 'interactive', activeVariant: 'white', selectedVariant: 'white'
                }).alter({scale: this._largeTop ? 1 : 0.75}).applyTo(minimizeIconDiv)

                topDiv.append(minimizeIconDiv)
            }

            if (this._closable &amp;&amp; !this._minimizable) {
                let closeIconDiv = $('&lt;div>&lt;/div>', {class: 'qui-base-button qui-structured-view-close-button'})

                new StockIcon({
                    name: 'close', variant: 'interactive',
                    activeVariant: 'interactive-active', selectedVariant: 'interactive'
                }).alter({scale: this._largeTop ? 1 : 0.75}).applyTo(closeIconDiv)

                topDiv.append(closeIconDiv)

                closeIconDiv.on('click', function () {
                    this.close().catch().then(function () {
                        logger.debug('breadcrumb navigation cancelled by rejected page close')
                    })
                }.bind(this))
            }

            return topDiv
        }

        /**
         * Implement this method to create the actual body of the view.
         * @abstract
         * @returns {jQuery}
         */
        makeBody() {
        }

        /**
         * Implement this method to create the bottom part of the view.
         * @returns {jQuery}
         */
        makeBottom() {
            return null
        }

        /**
         * Return the top element.
         * @returns {jQuery}
         */
        getTop() {
            /* Make sure the HTML is created */
            this.getHTML()

            return this._topDiv
        }

        /**
         * Return the body element.
         * @returns {jQuery}
         */
        getBody() {
            /* Make sure the HTML is created */
            this.getHTML()

            return this._bodyDiv
        }

        /**
         * Return the bottom element.
         * @returns {?jQuery}
         */
        getBottom() {
            /* Make sure the HTML is created */
            this.getHTML()

            return this._bottomDiv
        }


        /* Title and icon */

        /**
         * Return the view title.
         * @returns {?String}
         */
        getTitle() {
            return this._title
        }

        /**
         * Set the view title.
         * @param {String} title the new title
         */
        setTitle(title) {
            this._title = title
            this.getTop().children('span.qui-structured-view-title').html(title || '')
        }

        /**
         * Return the view icon.
         * @returns {qui.icons.Icon}
         */
        getIcon() {
            return this._icon
        }

        /**
         * Set the view icon.
         * @param {?qui.icons.Icon} icon the new icon (`null` to disable icon)
         */
        setIcon(icon) {
            this._icon = icon
            let iconDiv = this.getTop().children('div.qui-structured-view-icon')
            if (this._icon) {
                this.getHTML().removeClass('iconless')
                this.prepareIcon(this._icon).applyTo(iconDiv)
            }
            else {
                this.getHTML().addClass('iconless')
                iconDiv.html('')
            }
        }

        /**
         * Prepare the view icon, altering its attributes as needed, before applying it.
         * @param {qui.icons.Icon} icon
         * @returns {qui.icons.Icon}
         */
        prepareIcon(icon) {
            if (!(icon instanceof StockIcon)) {
                return icon
            }

            if (this._minimizable) {
                icon = icon.alterDefault({
                    variant: 'interactive',
                    activeVariant: 'white',
                    selectedVariant: 'white'
                })
            }
            else {
                icon = icon.alterDefault({variant: Window.isSmallScreen() ? 'white' : 'foreground'})
            }

            return icon
        }


        /* Minimization */

        /**
         * Minimize the view.
         */
        minimize() {
            if (this._minimized) {
                return
            }

            this._minimized = true

            this.getHTML().addClass('minimized')
            this.getTop().removeClass('selected')
            this._bodyVisibilityManager.hideElement()

            this.onMinimize()
        }

        /**
         * Restore the view's minimization to normal state.
         */
        unminimize() {
            if (!this._minimized) {
                return
            }

            this._minimized = false

            this.getHTML().removeClass('minimized')
            this.getTop().addClass('selected')
            this._bodyVisibilityManager.showElement()

            this.onUnminimize()
        }

        /**
         * Toggle the view's minimization state.
         */
        toggleMinimized() {
            if (this.isMinimized()) {
                this.unminimize()
            }
            else {
                this.minimize()
            }
        }

        /**
         * Tell if the view is minimized or not.
         * @returns {Boolean}
         */
        isMinimized() {
            return this._minimized
        }

        /**
         * Tell if the view is minimizable or not.
         * @returns {Boolean}
         */
        isMinimizable() {
            return this._minimizable
        }

        /**
         * Called when the view is minimized.
         */
        onMinimize() {
        }

        /**
         * Called when the view is unminimized.
         */
        onUnminimize() {
        }

    }

    return StructuredViewMixin

})


export default StructuredViewMixin
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="qui.html">qui</a></li><li><a href="qui.base.html">base</a></li><li><a href="qui.base.errors.html">errors</a></li><li><a href="qui.base.i18n.html">i18n</a></li><li><a href="qui.base.mixwith.html">mixwith</a></li><li><a href="qui.config.html">config</a></li><li><a href="qui.forms.html">forms</a></li><li><a href="qui.forms.commonfields.html">commonfields</a></li><li><a href="qui.forms.commonforms.html">commonforms</a></li><li><a href="qui.globalglass.html">globalglass</a></li><li><a href="qui.icons.html">icons</a></li><li><a href="qui.icons.defaultstock.html">defaultstock</a></li><li><a href="qui.icons.stocks.html">stocks</a></li><li><a href="qui.lists.html">lists</a></li><li><a href="qui.lists.commonitems.html">commonitems</a></li><li><a href="qui.lists.commonlists.html">commonlists</a></li><li><a href="qui.mainui.html">mainui</a></li><li><a href="qui.mainui.menubar.html">menubar</a></li><li><a href="qui.mainui.optionsbar.html">optionsbar</a></li><li><a href="qui.mainui.status.html">status</a></li><li><a href="qui.mainui.topbar.html">topbar</a></li><li><a href="qui.messages.html">messages</a></li><li><a href="qui.messages.commonmessageforms.html">commonmessageforms</a></li><li><a href="qui.messages.toast.html">toast</a></li><li><a href="qui.navigation.html">navigation</a></li><li><a href="qui.pages.html">pages</a></li><li><a href="qui.pages.commonpages.html">commonpages</a></li><li><a href="qui.pwa.html">pwa</a></li><li><a href="qui.sections.html">sections</a></li><li><a href="qui.tables.html">tables</a></li><li><a href="qui.tables.commoncells.html">commoncells</a></li><li><a href="qui.tables.commontables.html">commontables</a></li><li><a href="qui.theme.html">theme</a></li><li><a href="qui.utils.html">utils</a></li><li><a href="qui.utils.ajax.html">ajax</a></li><li><a href="qui.utils.array.html">array</a></li><li><a href="qui.utils.colors.html">colors</a></li><li><a href="qui.utils.cookies.html">cookies</a></li><li><a href="qui.utils.crypto.html">crypto</a></li><li><a href="qui.utils.css.html">css</a></li><li><a href="qui.utils.date.html">date</a></li><li><a href="qui.utils.files.html">files</a></li><li><a href="qui.utils.gestures.html">gestures</a></li><li><a href="qui.utils.html.html">html</a></li><li><a href="qui.utils.misc.html">misc</a></li><li><a href="qui.utils.object.html">object</a></li><li><a href="qui.utils.promise.html">promise</a></li><li><a href="qui.utils.string.html">string</a></li><li><a href="qui.views.html">views</a></li><li><a href="qui.views.commonviews.html">commonviews</a></li><li><a href="qui.widgets.html">widgets</a></li><li><a href="qui.window.html">window</a></li></ul><h3>Classes</h3><ul><li><a href="qui.base.ConditionVariable.html">ConditionVariable</a></li><li><a href="qui.base.errors.AssertionError.html">AssertionError</a></li><li><a href="qui.base.errors.CancelledError.html">CancelledError</a></li><li><a href="qui.base.errors.NotImplementedError.html">NotImplementedError</a></li><li><a href="qui.base.errors.TimeoutError.html">TimeoutError</a></li><li><a href="qui.base.mixwith.MixinBuilder.html">MixinBuilder</a></li><li><a href="qui.base.Signal.html">Signal</a></li><li><a href="qui.base.Timer.html">Timer</a></li><li><a href="qui.forms.commonfields.CheckField.html">CheckField</a></li><li><a href="qui.forms.commonfields.ChoiceButtonsField.html">ChoiceButtonsField</a></li><li><a href="qui.forms.commonfields.ColorComboField.html">ColorComboField</a></li><li><a href="qui.forms.commonfields.ComboField.html">ComboField</a></li><li><a href="qui.forms.commonfields.CompositeField.html">CompositeField</a></li><li><a href="qui.forms.commonfields.CustomHTMLField.html">CustomHTMLField</a></li><li><a href="qui.forms.commonfields.EmailField.html">EmailField</a></li><li><a href="qui.forms.commonfields.FilePickerField.html">FilePickerField</a></li><li><a href="qui.forms.commonfields.JQueryUIField.html">JQueryUIField</a></li><li><a href="qui.forms.commonfields.LabelsField.html">LabelsField</a></li><li><a href="qui.forms.commonfields.NumericField.html">NumericField</a></li><li><a href="qui.forms.commonfields.PasswordField.html">PasswordField</a></li><li><a href="qui.forms.commonfields.PhoneField.html">PhoneField</a></li><li><a href="qui.forms.commonfields.ProgressDiskField.html">ProgressDiskField</a></li><li><a href="qui.forms.commonfields.PushButtonField.html">PushButtonField</a></li><li><a href="qui.forms.commonfields.SliderField.html">SliderField</a></li><li><a href="qui.forms.commonfields.TextAreaField.html">TextAreaField</a></li><li><a href="qui.forms.commonfields.TextField.html">TextField</a></li><li><a href="qui.forms.commonfields.UpDownField.html">UpDownField</a></li><li><a href="qui.forms.commonforms.OptionsForm.html">OptionsForm</a></li><li><a href="qui.forms.commonforms.PageForm.html">PageForm</a></li><li><a href="qui.forms.ErrorMapping.html">ErrorMapping</a></li><li><a href="qui.forms.Form.html">Form</a></li><li><a href="qui.forms.FormButton.html">FormButton</a></li><li><a href="qui.forms.FormField.html">FormField</a></li><li><a href="qui.forms.ValidationError.html">ValidationError</a></li><li><a href="qui.icons.Icon.html">Icon</a></li><li><a href="qui.icons.MultiStateSpritesIcon.html">MultiStateSpritesIcon</a></li><li><a href="qui.icons.Stock.html">Stock</a></li><li><a href="qui.icons.StockIcon.html">StockIcon</a></li><li><a href="qui.lists.commonitems.IconLabelListItem.html">IconLabelListItem</a></li><li><a href="qui.lists.commonlists.PageList.html">PageList</a></li><li><a href="qui.lists.List.html">List</a></li><li><a href="qui.lists.ListItem.html">ListItem</a></li><li><a href="qui.messages.commonmessageforms.ConfirmMessageForm.html">ConfirmMessageForm</a></li><li><a href="qui.messages.commonmessageforms.SimpleMessageForm.html">SimpleMessageForm</a></li><li><a href="qui.messages.commonmessageforms.StickySimpleMessageForm.html">StickySimpleMessageForm</a></li><li><a href="qui.messages.MessageForm.html">MessageForm</a></li><li><a href="qui.messages.StickyModalProgressMessage.html">StickyModalProgressMessage</a></li><li><a href="qui.navigation.PageLoadError.html">PageLoadError</a></li><li><a href="qui.navigation.PageNotFoundError.html">PageNotFoundError</a></li><li><a href="qui.navigation.SectionLoadError.html">SectionLoadError</a></li><li><a href="qui.pages.commonpages.ModalProgressPage.html">ModalProgressPage</a></li><li><a href="qui.pages.PagesContext.html">PagesContext</a></li><li><a href="qui.sections.HideCancelled.html">HideCancelled</a></li><li><a href="qui.sections.Section.html">Section</a></li><li><a href="qui.tables.commoncells.IconLabelTableCell.html">IconLabelTableCell</a></li><li><a href="qui.tables.commoncells.PushButtonTableCell.html">PushButtonTableCell</a></li><li><a href="qui.tables.commoncells.SimpleTableCell.html">SimpleTableCell</a></li><li><a href="qui.tables.commontables.PageTable.html">PageTable</a></li><li><a href="qui.tables.Table.html">Table</a></li><li><a href="qui.tables.TableCell.html">TableCell</a></li><li><a href="qui.tables.TableRow.html">TableRow</a></li><li><a href="qui.utils.crypto.HMACSHA256.html">HMACSHA256</a></li><li><a href="qui.utils.crypto.SHA256.html">SHA256</a></li><li><a href="qui.utils.URL.html">URL</a></li><li><a href="qui.utils.VisibilityManager.html">VisibilityManager</a></li><li><a href="qui.views.commonviews.IconLabelViewMixin.html">IconLabelViewMixin</a></li></ul><h3>Mixins</h3><ul><li><a href="qui.base.SingletonMixin.html">SingletonMixin</a></li><li><a href="qui.messages.StickyModalPageMixin.html">StickyModalPageMixin</a></li><li><a href="qui.pages.commonpages.StructuredPageMixin.html">StructuredPageMixin</a></li><li><a href="qui.pages.PageMixin.html">PageMixin</a></li><li><a href="qui.views.commonviews.ProgressViewMixin.html">ProgressViewMixin</a></li><li><a href="qui.views.commonviews.StructuredViewMixin.html">StructuredViewMixin</a></li><li><a href="qui.views.ViewMixin.html">ViewMixin</a></li></ul><h3>Global</h3><ul><li><a href="global.html#cleanup">cleanup</a></li><li><a href="global.html#getHTML">getHTML</a></li><li><a href="global.html#getServiceWorker">getServiceWorker</a></li><li><a href="global.html#isClass">isClass</a></li><li><a href="global.html#isFunction">isFunction</a></li><li><a href="global.html#isObject">isObject</a></li><li><a href="global.html#isServiceWorkerSupported">isServiceWorkerSupported</a></li><li><a href="global.html#makeToken">makeToken</a></li><li><a href="global.html#navigateInitial">navigateInitial</a></li><li><a href="global.html#reset">reset</a></li><li><a href="global.html#sendServiceWorkerMessage">sendServiceWorkerMessage</a></li><li><a href="global.html#serviceWorkerMessageSignal">serviceWorkerMessageSignal</a></li><li><a href="global.html#whenServiceWorkerReady">whenServiceWorkerReady</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Thu Jan 07 2021 20:01:23 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
