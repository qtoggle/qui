<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: utils/date.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: utils/date.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @namespace qui.utils.date
 */

/* eslint-disable no-multi-spaces */

import {gettext} from '$qui/base/i18n.js'


const MONTH_NAMES = [
    {longName: 'January',   shortName: 'Jan', longNameTrans: gettext('January'),   shortNameTrans: gettext('Jan')},
    {longName: 'February',  shortName: 'Feb', longNameTrans: gettext('February'),  shortNameTrans: gettext('Feb')},
    {longName: 'March',     shortName: 'Mar', longNameTrans: gettext('March'),     shortNameTrans: gettext('Mar')},
    {longName: 'April',     shortName: 'Apr', longNameTrans: gettext('April'),     shortNameTrans: gettext('Apr')},
    {longName: 'May',       shortName: 'May', longNameTrans: gettext('May'),       shortNameTrans: gettext('May')},
    {longName: 'June',      shortName: 'Jun', longNameTrans: gettext('June'),      shortNameTrans: gettext('Jun')},
    {longName: 'July',      shortName: 'Jul', longNameTrans: gettext('July'),      shortNameTrans: gettext('Jul')},
    {longName: 'August',    shortName: 'Aug', longNameTrans: gettext('August'),    shortNameTrans: gettext('Aug')},
    {longName: 'September', shortName: 'Sep', longNameTrans: gettext('September'), shortNameTrans: gettext('Sep')},
    {longName: 'October',   shortName: 'Oct', longNameTrans: gettext('October'),   shortNameTrans: gettext('Oct')},
    {longName: 'November',  shortName: 'Nov', longNameTrans: gettext('November'),  shortNameTrans: gettext('Nov')},
    {longName: 'December',  shortName: 'Dec', longNameTrans: gettext('December'),  shortNameTrans: gettext('Dec')}
]

const WEEK_DAY_NAMES = [
    {longName: 'Sunday',    shortName: 'Sun', longNameTrans: gettext('Sunday'),    shortNameTrans: gettext('Sun')},
    {longName: 'Monday',    shortName: 'Mon', longNameTrans: gettext('Monday'),    shortNameTrans: gettext('Mon')},
    {longName: 'Tuesday',   shortName: 'Tue', longNameTrans: gettext('Tuesday'),   shortNameTrans: gettext('Tue')},
    {longName: 'Wednesday', shortName: 'Wed', longNameTrans: gettext('Wednesday'), shortNameTrans: gettext('Wed')},
    {longName: 'Thursday',  shortName: 'Thu', longNameTrans: gettext('Thursday'),  shortNameTrans: gettext('Thu')},
    {longName: 'Friday',    shortName: 'Fri', longNameTrans: gettext('Friday'),    shortNameTrans: gettext('Fri')},
    {longName: 'Saturday',  shortName: 'Sat', longNameTrans: gettext('Saturday'),  shortNameTrans: gettext('Sat')}
]

const MILLISECONDS_IN_MINUTE = 60 * 1000
const MILLISECONDS_IN_HOUR = 60 * MILLISECONDS_IN_MINUTE
const MILLISECONDS_IN_DAY = 24 * MILLISECONDS_IN_HOUR


/**
 * Transform a date into a string, according to the given format. Recognized placeholders:
 *  * `"%a"` - short week day name (e.g. `"Mon"`)
 *  * `"%A"` - long week day name (e.g. `"Monday"`)
 *  * `"%w"` - day of week, from `"0"` (Sunday) to `"6"` (Saturday),
 *  * `"%u"` - day of week, from `"1"` (Monday) to `"7"` (Sunday),
 *  * `"%d"` - zero padded day of month, from `"00"` to `"31'`
 *  * `"%b"` - short month name (e.g. `"Apr"`)
 *  * `"%B"` - long month name (e.g. `"April"`)
 *  * `"%m"` - zero padded month number, from `"01"` to `"12"`
 *  * `"%y"` - zero padded short year (e.g. `"97"` or `"03"`)
 *  * `"%Y"` - zero padded long year (e.g. `"1997"` or `"2003"`)
 *  * `"%H"` - zero padded hour, from `"00"` to `"23"`
 *  * `"%I"` - zero padded hour, from `"00"` to `"11"`
 *  * `"%p"` - `"am"` or `"pm"`
 *  * `"%M"` - zero padded minutes, from `"00"` to `"59"`
 *  * `"%S"` - zero padded seconds, from `"00"` to `"59"`
 *  * `"%f"` - zero padded milliseconds, from `"000"` to `"999"`
 *
 * Use a `-` character in front of a format specifier to remove zero padding (e.g. "%-d"`).
 *
 * @alias qui.utils.date.formatPercent
 * @param {Date} date the date to format
 * @param {String} format the format to be used
 * @param {Boolean} [trans] whether to translate week day and month names; defaults to `true`
 * @returns {String} the formatted date
 */
export function formatPercent(date, format, trans = true) {
    if (!date || isNaN(date.getTime())) {
        return ''
    }

    let weekDay = date.getDay()
    let monthDay = date.getDate()
    let month = date.getMonth()
    let year = date.getFullYear()
    let hours = date.getHours()
    let minutes = date.getMinutes()
    let seconds = date.getSeconds()
    let milliseconds = date.getMilliseconds()

    let hours12
    if (hours === 0) {
        hours12 = 12
    }
    else if (hours &lt; 13) {
        hours12 = hours
    }
    else { /* Hours between 13 and 23 */
        hours12 = hours % 12
    }

    let ampm = hours &lt; 12 ? 'AM' : 'PM'
    let weekDayName = WEEK_DAY_NAMES[weekDay]
    let weekDayNameShort = trans ? weekDayName.shortNameTrans : weekDayName.shortName
    let weekDayNameLong = trans ? weekDayName.longNameTrans : weekDayName.longName
    let monthName = MONTH_NAMES[month]
    let monthNameShort = trans ? monthName.shortNameTrans : monthName.shortName
    let monthNameLong = trans ? monthName.longNameTrans : monthName.longName

    let result = ''
    let percent = false
    let noLeading = false
    for (let i = 0; i &lt; format.length; i++) {
        let c = format.charAt(i)
        if (percent) {
            if (c === '-') {
                noLeading = true
            }
            else {
                switch (c) {
                    case 'a':
                        result += weekDayNameShort
                        break

                    case 'A':
                        result += weekDayNameLong
                        break

                    case 'w':
                        result += weekDay.toString()
                        break

                    case 'u':
                        result += (weekDay || 7).toString()
                        break

                    case 'd':
                        result += monthDay.toString().padStart(noLeading ? 0 : 2, '0')
                        break

                    case 'b':
                        result += monthNameShort
                        break

                    case 'B':
                        result += monthNameLong
                        break

                    case 'm':
                        result += (month + 1).toString().padStart(noLeading ? 0 : 2, '0')
                        break

                    case 'y':
                        result += (year % 100).toString().padStart(noLeading ? 0 : 2, '0')
                        break

                    case 'Y':
                        result += year.toString().padStart(noLeading ? 0 : 4, '0')
                        break

                    case 'H':
                        result += hours.toString().padStart(noLeading ? 0 : 2, '0')
                        break

                    case 'I':
                        result += hours12.toString().padStart(noLeading ? 0 : 2, '0')
                        break

                    case 'p':
                        result += ampm
                        break

                    case 'M':
                        result += minutes.toString().padStart(noLeading ? 0 : 2, '0')
                        break

                    case 'S':
                        result += seconds.toString().padStart(noLeading ? 0 : 2, '0')
                        break

                    case 'f':
                        result += milliseconds.toString().padStart(noLeading ? 0 : 3, '0')
                        break

                    case '%':
                        result += '%'
                        break
                }

                noLeading = false
                percent = false
            }
        }
        else if (c === '%') {
            percent = true
        }
        else {
            result += c
        }
    }

    return result
}

/**
 * Transform a time duration into a string, according to the given format. Recognized placeholders:
 *  * `"%d"` - number of days
 *  * `"%H"` - number of hours, from `"00"` to `"23"`
 *  * `"%M"` - number of minutes, from `"00"` to `"59"`
 *  * `"%S"` - number of seconds, from `"00"` to `"59"`
 *  * `"%f"` - number of milliseconds, from `"000"` to `"999"`
 *
 * Use a `-` character in front of a format specifier to remove zero padding (e.g. "%-H"`).
 *
 * @alias qui.utils.date.formatDurationPercent
 * @param {Number} duration duration, in milliseconds
 * @param {String} format the format to be used
 * @returns {String} the formatted duration
 */
export function formatDurationPercent(duration, format) {
    let negative = false
    if (duration &lt; 0) {
        duration = -duration
        negative = true
    }

    let days = Math.floor(duration / MILLISECONDS_IN_DAY)
    duration = duration % MILLISECONDS_IN_DAY

    let hours = Math.floor(duration / MILLISECONDS_IN_HOUR)
    duration = duration % MILLISECONDS_IN_HOUR

    let minutes = Math.floor(duration / MILLISECONDS_IN_MINUTE)
    duration = duration % MILLISECONDS_IN_MINUTE

    let seconds = Math.floor(duration / 1000)
    let milliseconds = duration % 1000

    let result = ''
    let percent = false
    let noLeading = false
    for (let i = 0; i &lt; format.length; i++) {
        let c = format.charAt(i)
        if (percent) {
            if (c === '-') {
                noLeading = true
            }
            else {
                switch (c) {
                    case 'd':
                        result += days.toString()
                        break

                    case 'H':
                        result += hours.toString().padStart(noLeading ? 0 : 2, '0')
                        break

                    case 'M':
                        result += minutes.toString().padStart(noLeading ? 0 : 2, '0')
                        break

                    case 'S':
                        result += seconds.toString().padStart(noLeading ? 0 : 2, '0')
                        break

                    case 'f':
                        result += milliseconds.toString().padStart(noLeading ? 0 : 3, '0')
                        break

                    case '%':
                        result += '%'
                        break
                }

                noLeading = false
                percent = false
            }
        }
        else if (c === '%') {
            percent = true
        }
        else {
            result += c
        }
    }

    if (negative) {
        result = `-${result}`
    }

    return result
}

/**
 * Transform a given date object into its UTC equivalent.
 * @alias qui.utils.date.toUTC
 * @param {Date} date
 * @returns {Date}
 */
export function toUTC(date) {
    return new Date(
        date.getUTCFullYear(),
        date.getUTCMonth(),
        date.getUTCDate(),
        date.getUTCHours(),
        date.getUTCMinutes(),
        date.getUTCSeconds(),
        date.getUTCMilliseconds()
    )
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="qui.html">qui</a></li><li><a href="qui.base.html">base</a></li><li><a href="qui.base.errors.html">errors</a></li><li><a href="qui.base.i18n.html">i18n</a></li><li><a href="qui.base.mixwith.html">mixwith</a></li><li><a href="qui.config.html">config</a></li><li><a href="qui.forms.html">forms</a></li><li><a href="qui.forms.commonfields.html">commonfields</a></li><li><a href="qui.forms.commonforms.html">commonforms</a></li><li><a href="qui.globalglass.html">globalglass</a></li><li><a href="qui.icons.html">icons</a></li><li><a href="qui.icons.defaultstock.html">defaultstock</a></li><li><a href="qui.icons.stocks.html">stocks</a></li><li><a href="qui.lists.html">lists</a></li><li><a href="qui.lists.commonitems.html">commonitems</a></li><li><a href="qui.lists.commonlists.html">commonlists</a></li><li><a href="qui.mainui.html">mainui</a></li><li><a href="qui.mainui.menubar.html">menubar</a></li><li><a href="qui.mainui.optionsbar.html">optionsbar</a></li><li><a href="qui.mainui.status.html">status</a></li><li><a href="qui.mainui.topbar.html">topbar</a></li><li><a href="qui.messages.html">messages</a></li><li><a href="qui.messages.commonmessageforms.html">commonmessageforms</a></li><li><a href="qui.messages.toast.html">toast</a></li><li><a href="qui.navigation.html">navigation</a></li><li><a href="qui.pages.html">pages</a></li><li><a href="qui.pages.commonpages.html">commonpages</a></li><li><a href="qui.pwa.html">pwa</a></li><li><a href="qui.sections.html">sections</a></li><li><a href="qui.tables.html">tables</a></li><li><a href="qui.tables.commoncells.html">commoncells</a></li><li><a href="qui.tables.commontables.html">commontables</a></li><li><a href="qui.theme.html">theme</a></li><li><a href="qui.utils.html">utils</a></li><li><a href="qui.utils.ajax.html">ajax</a></li><li><a href="qui.utils.array.html">array</a></li><li><a href="qui.utils.colors.html">colors</a></li><li><a href="qui.utils.cookies.html">cookies</a></li><li><a href="qui.utils.crypto.html">crypto</a></li><li><a href="qui.utils.css.html">css</a></li><li><a href="qui.utils.date.html">date</a></li><li><a href="qui.utils.files.html">files</a></li><li><a href="qui.utils.gestures.html">gestures</a></li><li><a href="qui.utils.html.html">html</a></li><li><a href="qui.utils.misc.html">misc</a></li><li><a href="qui.utils.object.html">object</a></li><li><a href="qui.utils.promise.html">promise</a></li><li><a href="qui.utils.string.html">string</a></li><li><a href="qui.views.html">views</a></li><li><a href="qui.views.commonviews.html">commonviews</a></li><li><a href="qui.widgets.html">widgets</a></li><li><a href="qui.window.html">window</a></li></ul><h3>Classes</h3><ul><li><a href="qui.base.ConditionVariable.html">ConditionVariable</a></li><li><a href="qui.base.errors.AssertionError.html">AssertionError</a></li><li><a href="qui.base.errors.CancelledError.html">CancelledError</a></li><li><a href="qui.base.errors.NotImplementedError.html">NotImplementedError</a></li><li><a href="qui.base.errors.TimeoutError.html">TimeoutError</a></li><li><a href="qui.base.mixwith.MixinBuilder.html">MixinBuilder</a></li><li><a href="qui.base.Signal.html">Signal</a></li><li><a href="qui.base.Timer.html">Timer</a></li><li><a href="qui.forms.commonfields.CheckField.html">CheckField</a></li><li><a href="qui.forms.commonfields.ChoiceButtonsField.html">ChoiceButtonsField</a></li><li><a href="qui.forms.commonfields.ColorComboField.html">ColorComboField</a></li><li><a href="qui.forms.commonfields.ComboField.html">ComboField</a></li><li><a href="qui.forms.commonfields.CompositeField.html">CompositeField</a></li><li><a href="qui.forms.commonfields.CustomHTMLField.html">CustomHTMLField</a></li><li><a href="qui.forms.commonfields.EmailField.html">EmailField</a></li><li><a href="qui.forms.commonfields.FilePickerField.html">FilePickerField</a></li><li><a href="qui.forms.commonfields.JQueryUIField.html">JQueryUIField</a></li><li><a href="qui.forms.commonfields.LabelsField.html">LabelsField</a></li><li><a href="qui.forms.commonfields.NumericField.html">NumericField</a></li><li><a href="qui.forms.commonfields.PasswordField.html">PasswordField</a></li><li><a href="qui.forms.commonfields.PhoneField.html">PhoneField</a></li><li><a href="qui.forms.commonfields.ProgressDiskField.html">ProgressDiskField</a></li><li><a href="qui.forms.commonfields.PushButtonField.html">PushButtonField</a></li><li><a href="qui.forms.commonfields.SliderField.html">SliderField</a></li><li><a href="qui.forms.commonfields.TextAreaField.html">TextAreaField</a></li><li><a href="qui.forms.commonfields.TextField.html">TextField</a></li><li><a href="qui.forms.commonfields.UpDownField.html">UpDownField</a></li><li><a href="qui.forms.commonforms.OptionsForm.html">OptionsForm</a></li><li><a href="qui.forms.commonforms.PageForm.html">PageForm</a></li><li><a href="qui.forms.ErrorMapping.html">ErrorMapping</a></li><li><a href="qui.forms.Form.html">Form</a></li><li><a href="qui.forms.FormButton.html">FormButton</a></li><li><a href="qui.forms.FormField.html">FormField</a></li><li><a href="qui.forms.ValidationError.html">ValidationError</a></li><li><a href="qui.icons.Icon.html">Icon</a></li><li><a href="qui.icons.MultiStateSpritesIcon.html">MultiStateSpritesIcon</a></li><li><a href="qui.icons.Stock.html">Stock</a></li><li><a href="qui.icons.StockIcon.html">StockIcon</a></li><li><a href="qui.lists.commonitems.IconLabelListItem.html">IconLabelListItem</a></li><li><a href="qui.lists.commonlists.PageList.html">PageList</a></li><li><a href="qui.lists.List.html">List</a></li><li><a href="qui.lists.ListItem.html">ListItem</a></li><li><a href="qui.messages.commonmessageforms.ConfirmMessageForm.html">ConfirmMessageForm</a></li><li><a href="qui.messages.commonmessageforms.SimpleMessageForm.html">SimpleMessageForm</a></li><li><a href="qui.messages.commonmessageforms.StickySimpleMessageForm.html">StickySimpleMessageForm</a></li><li><a href="qui.messages.MessageForm.html">MessageForm</a></li><li><a href="qui.messages.StickyModalProgressMessage.html">StickyModalProgressMessage</a></li><li><a href="qui.navigation.PageLoadError.html">PageLoadError</a></li><li><a href="qui.navigation.PageNotFoundError.html">PageNotFoundError</a></li><li><a href="qui.navigation.SectionLoadError.html">SectionLoadError</a></li><li><a href="qui.pages.commonpages.ModalProgressPage.html">ModalProgressPage</a></li><li><a href="qui.pages.PagesContext.html">PagesContext</a></li><li><a href="qui.sections.HideCancelled.html">HideCancelled</a></li><li><a href="qui.sections.Section.html">Section</a></li><li><a href="qui.tables.commoncells.IconLabelTableCell.html">IconLabelTableCell</a></li><li><a href="qui.tables.commoncells.PushButtonTableCell.html">PushButtonTableCell</a></li><li><a href="qui.tables.commoncells.SimpleTableCell.html">SimpleTableCell</a></li><li><a href="qui.tables.commontables.PageTable.html">PageTable</a></li><li><a href="qui.tables.Table.html">Table</a></li><li><a href="qui.tables.TableCell.html">TableCell</a></li><li><a href="qui.tables.TableRow.html">TableRow</a></li><li><a href="qui.utils.crypto.HMACSHA256.html">HMACSHA256</a></li><li><a href="qui.utils.crypto.SHA256.html">SHA256</a></li><li><a href="qui.utils.Debouncer.html">Debouncer</a></li><li><a href="qui.utils.URL.html">URL</a></li><li><a href="qui.utils.VisibilityManager.html">VisibilityManager</a></li><li><a href="qui.views.commonviews.IconLabelViewMixin.html">IconLabelViewMixin</a></li></ul><h3>Mixins</h3><ul><li><a href="qui.base.SingletonMixin.html">SingletonMixin</a></li><li><a href="qui.messages.StickyModalPageMixin.html">StickyModalPageMixin</a></li><li><a href="qui.pages.commonpages.StructuredPageMixin.html">StructuredPageMixin</a></li><li><a href="qui.pages.PageMixin.html">PageMixin</a></li><li><a href="qui.views.commonviews.ProgressViewMixin.html">ProgressViewMixin</a></li><li><a href="qui.views.commonviews.StructuredViewMixin.html">StructuredViewMixin</a></li><li><a href="qui.views.ViewMixin.html">ViewMixin</a></li></ul><h3>Global</h3><ul><li><a href="global.html#cleanup">cleanup</a></li><li><a href="global.html#getHTML">getHTML</a></li><li><a href="global.html#getServiceWorker">getServiceWorker</a></li><li><a href="global.html#isClass">isClass</a></li><li><a href="global.html#isFunction">isFunction</a></li><li><a href="global.html#isObject">isObject</a></li><li><a href="global.html#isServiceWorkerSupported">isServiceWorkerSupported</a></li><li><a href="global.html#makeToken">makeToken</a></li><li><a href="global.html#navigateInitial">navigateInitial</a></li><li><a href="global.html#reset">reset</a></li><li><a href="global.html#sendServiceWorkerMessage">sendServiceWorkerMessage</a></li><li><a href="global.html#serviceWorkerMessageSignal">serviceWorkerMessageSignal</a></li><li><a href="global.html#whenServiceWorkerReady">whenServiceWorkerReady</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.11</a> on Sun Feb 08 2026 11:02:06 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
